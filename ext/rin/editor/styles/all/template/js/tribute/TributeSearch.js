"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),TributeSearch=function(){function e(r){_classCallCheck(this,e),this.tribute=r,this.tribute.search=this}return _createClass(e,[{key:"simpleFilter",value:function(e,r){var t=this;return r.filter(function(r){return t.test(e,r)})}},{key:"test",value:function(e,r){return null!==this.match(e,r)}},{key:"match",value:function(e,r,t){t=t||{};r.length;var n=t.pre||"",a=t.post||"",i=t.caseSensitive&&r||r.toLowerCase();e=t.caseSensitive&&e||e.toLowerCase();var c=this.traverse(i,e,0,0,[]);return c?{rendered:this.render(r,c.cache,n,a),score:c.score}:null}},{key:"traverse",value:function(e,r,t,n,a){if(r.length===n)return{score:this.calculateScore(a),cache:a.slice()};if(e.length!==t&&r.length-n<=e.length-t){for(var i=r[n],c=e.indexOf(i,t),u=void 0,s=void 0;c>-1;){if(a.push(c),s=this.traverse(e,r,c+1,n+1,a),a.pop(),!s)return u;u&&u.score>=s.score||(u=s),c=e.indexOf(i,c+1)}return u}}},{key:"calculateScore",value:function(e){var r=0,t=1;return e.forEach(function(n,a){a>0&&(e[a-1]+1===n?t+=t+1:t=1),r+=t}),r}},{key:"render",value:function(e,r,t,n){var a=e.substring(0,r[0]);return r.forEach(function(i,c){a+=t+e[i]+n+e.substring(i+1,r[c+1]?r[c+1]:e.length)}),a}},{key:"filter",value:function(e,r,t){var n=this;return t=t||{},r.reduce(function(r,a,i,c){var u=a;t.extract&&((u=t.extract(a))||(u=""));var s=n.match(e,u,t);return null!=s&&(r[r.length]={string:s.rendered,score:s.score,index:i,original:a}),r},[]).sort(function(e,r){var t=r.score-e.score;return t||e.index-r.index})}}]),e}();exports.default=TributeSearch,module.exports=exports.default;